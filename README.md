# **TERRAARGOS - Vehicle Detection from Satellite Imagery**

Проект для детекции транспортных средств на спутниковых снимках с использованием архитектуры Faster R-CNN.

## **Структура проекта**
### TERRAARGOS/
#### ├── results/ # Результаты обучения и экспериментов
#### ├── src/ # Исходный код проекта
#### │ ├── data/ # Модули для работы с данными
#### │ │ ├── init.py
#### │ │ ├── dataloader.py # Создание DataLoader'ов
#### │ │ ├── dataset.py # Dataset класс для COCO формата
#### │ │ └── downloader.py # Загрузка и распаковка данных
#### │ ├── models/ # Модели нейросетей
#### │ │ ├── init.py
#### │ │ ├── anchors.py # Генератор anchor'ов для RPN
#### │ │ ├── faster_rcnn.py # Модель Faster R-CNN
#### │ │ └── metrics.py # Расчет метрик качества
#### │ ├── training/ # Скрипты обучения
#### │ │ └── trainer.py # Логика обучения модели
#### │ ├── utils/ # Вспомогательные утилиты
#### │ │ ├── init.py
#### │ │ ├── logger.py # Логирование процесса
#### │ │ └── config.py # Конфигурационные параметры
#### │ └── visualization/ # Визуализация результатов
#### │ ├── init.py
#### │ └── metrics_plots.py # Построение графиков метрик
#### ├── VME_data/ # Данные проекта (автосоздается)
#### ├── weights/ # Веса моделей (автосоздается)
#### ├── detect_vehicles.py # Скрипт детекции на новых изображениях
#### ├── metrics_analyzer.py # Анализ метрик обучения
#### ├── run_training.py # Основной скрипт обучения
#### └── requirements.txt # Зависимости проекта


## **Основные скрипты**

### **`run_training.py`**

Главный скрипт для обучения модели:

*   Проверяет наличие данных
*   Создает датасеты и модель
*   Запускает двухстадийное обучение
*   Сохраняет чекпоинты и финальную модель

### **`detect_vehicles.py`**

Скрипт для инференса:

*   Загружает обученную модель
*   Детектирует транспорт на изображениях
*   Визуализирует результаты с bounding boxes
*   Сохраняет обработанные изображения

### **`metrics_analyzer.py`**

Анализ результатов обучения:

*   Анализирует CSV файлы с метриками
*   Строит графики accuracy по эпохам
*   Генерирует отчеты о качестве модели

## **Модули исходного кода**

### **`src/data/`**

**`dataset.py`** - `CocoDetectionForFasterRCNN` класс для работы с данными в COCO формата

**`dataloader.py`** - Функции для создания DataLoader'ов с нужными трансформациями

**`downloader.py`** - Утилиты для загрузки и подготовки данных

### **`src/models/`**

**`faster_rcnn.py`** - Основная модель детекции:

*   `get_model()` - создание стандартной Faster R-CNN
*   `get_model_with_anchors()` - версия с кастомными anchor'ами
*   `freeze_backbone()` / `unfreeze_backbone()` - управление обучением backbone

**`anchors.py`** - Настройка anchor generator для Region Proposal Network

**`metrics.py`** - Расчет метрик (accuracy, IoU, precision/recall)

### **`src/training/`**

**`trainer.py`** - Логика обучения одной эпохи, валидация, сохранение моделей

### **`src/utils/`**

**`config.py`** - Централизованная конфигурация всех параметров:

*   Пути к данным
*   Гиперпараметры обучения
*   Настройки модели и anchor'ов
*   Пороги детекции

## **Структура данных**

Проект ожидает данные в следующем формате:
#### VME_data/
#### └── VME_CDSI_datasets/
#### ├── satellite_images/ # Спутниковые снимки
#### │ ├── image_001.tif
#### │ ├── image_002.tif
#### │ └── ...
#### └── annotations_HBB/ # Аннотации в COCO формате
#### ├── train.json # Тренировочные разметки
#### └── val.json # Валидационные разметки
